<script>
  // Mapa de idiomas para tus propios canales
  const canalesChampions = [
    { nombre: "HD5", idioma: "Ingl√©s", url: "https://sportzonline.live/channels/hd/hd5.php" },
    { nombre: "HD6", idioma: "Espa√±ol", url: "https://sportzonline.live/channels/hd/hd6.php" },
    { nombre: "Eleven2", idioma: "Portugu√©s", url: "https://sportzonline.live/channels/pt/eleven2.php" },
    { nombre: "BR3", idioma: "Portugu√©s (Brasil)", url: "https://sportzonline.live/channels/bra/br3.php" }
  ];

  function toggleCanales(index) {
    const canales = document.getElementById(`canales-${index}`);
    canales.style.display = canales.style.display === 'block' ? 'none' : 'block';
  }

  fetch('/api/partidos')
    .then(response => {
      if (!response.ok) throw new Error('Error en la API');
      return response.json();
    })
    .then(data => {
      const hoy = new Date().toISOString().split('T')[0];
      const partidosHoy = data.matches.filter(m => m.utcDate.startsWith(hoy));
      const contenedor = document.getElementById('agenda');

      if (partidosHoy.length === 0) {
        contenedor.innerHTML = '<p>No hay partidos programados para hoy.</p>';
        return;
      }

      let html = '';
      partidosHoy.forEach((p, index) => {
        const fecha = new Date(p.utcDate);
        const hora = fecha.toLocaleTimeString('es-ES', { hour: '2-digit', minute: '2-digit', hour12: false });
        const local = p.homeTeam?.name || 'Local';
        const visitante = p.awayTeam?.name || 'Visitante';
        const codigoLiga = p.competition?.code || '';
        const nombreLiga = p.competition?.name || 'Competici√≥n';

        // Solo para Champions League (c√≥digo "CL")
        let botones = '';
        if (codigoLiga === 'CL') {
          canalesChampions.forEach(canal => {
            botones += `<a href="${canal.url}" class="btn" target="_blank">${canal.nombre} (${canal.idioma})</a>`;
          });
        } else {
          // Para otras ligas, usa enlaces gen√©ricos a tu web o a Star+
          botones = `<a href="https://sportzonline.live" class="btn" target="_blank">Ver en mi web</a>`;
        }

        html += `
          <div class="partido" onclick="toggleCanales(${index})">
            <strong>${hora}</strong> ‚Äî ${local} vs ${visitante}<br>
            <small>üèÜ ${nombreLiga}</small>
            <div id="canales-${index}" class="canales">
              ${botones}
            </div>
          </div>
        `;
      });

      contenedor.innerHTML = html;
    })
    .catch(err => {
      document.getElementById('agenda').innerHTML = 
        `<p class="error">‚ùå Error: ${err.message}</p>`;
    });
</script>
